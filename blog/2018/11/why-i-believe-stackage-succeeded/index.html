
    

<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>Why (I believe) Stackage succeeded</title>

    <meta name="twitter:site" content="@snoyberg">
    <meta name="twitter:creator" content="@snoyberg">
    <meta name="og:site_name" content="Michael Snoyman's homepage">
    <meta name="og:title" content="Why (I believe) Stackage succeeded">
    <meta name="og:type content="website">

    <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"> 
    <link rel="stylesheet" href="/maxi/vendors/font-awesome/css/fontawesome-all.min.css">
    <link rel="stylesheet" type="text/css" href="/maxi/css/styles.css">

    

<meta name="og:description" value="Some thoughts on what I believe has made Stackage a successful project.
">






    <link rel="openid2.provider" href="https://openid.stackexchange.com/openid/provider">
    <link rel="openid2.local_id" href="https://openid.stackexchange.com/user/d26546d2-46db-4099-83ca-e1eccfa0dd8d">
    <link href="/rss.xml" type="application/atom+xml" rel="alternate" title="Michael Snoyman's blog">

    <style>.wt-section { padding-top: 2rem }</style>
  <body>
    <header class="inner-page">
      

<nav class="js-navbar-scroll navbar fixed-top navbar-expand-lg">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">
      <img src="/img/snoylogo.png" height="50px">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo" aria-controls="navbarTogglerDemo" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse onCollapse" id="navbarTogglerDemo">
      <ul class="navbar-nav ml-auto mt-2 mt-lg-0">
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="/blog">Blog</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://www.yesodweb.com/">Yesod</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="http://shop.oreilly.com/product/0636920035664.do">Yesod Book</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://www.beginrust.com/">Rust Book</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://www.youtube.com/c/snoyberg">YouTube</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://twitter.com/snoyberg">Twitter</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://github.com/snoyberg">Github</a>
        </li>
      </ul>
    </div>
  </div>
</nav>



      <section class="wt-section bg-gray text-center inner-page-header" style="padding-top:100px">
        <div class="container">
          <div class="row justify-content-md-center align-items-center text-white py-lg-5">
            <div class="col-md-7">
              <div class="text-center">
                <h1 class="display-sm-4 display-lg-3">Why (I believe) Stackage succeeded</h1>
                
<p class="h6 text-uppercase wt-letter-spacing-sm mb-0">Published November 20, 2018</p>

              </div>
            </div>
          </div>
        </div>
      </section>
    </header>

    <main role="main">
      <section class="wt-section">
        <div class="container">
          <div class="row justify-content-between">
            <div class="col-lg-12">
              <p class="text-center">
                <a class="btn" style="background: #72472f; color: #fff; font-weight: bold" href="https://www.beginrust.com/">New: The "Begin Rust" book</a>
              </p>

              




  


<div class="share-bar-wrapper">
  <div class="share-bar-inner">
    <b>Share this</b>
    <a target="_blank" href="https://twitter.com/intent/tweet?text=Why%20%28I%20believe%29%20Stackage%20succeeded https%3A&#x2F;&#x2F;www.snoyman.com&#x2F;blog&#x2F;2018&#x2F;11&#x2F;why-i-believe-stackage-succeeded&#x2F;" title="Share on Twitter">
      <i class="fab fa-twitter"></i>
    </a>

    <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A&#x2F;&#x2F;www.snoyman.com&#x2F;blog&#x2F;2018&#x2F;11&#x2F;why-i-believe-stackage-succeeded&#x2F;" title="Share on Facebook">
      <i class="fab fa-facebook"></i>
    </a>

    <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A&#x2F;&#x2F;www.snoyman.com&#x2F;blog&#x2F;2018&#x2F;11&#x2F;why-i-believe-stackage-succeeded&#x2F;&amp;title=Why%20%28I%20believe%29%20Stackage%20succeeded" title="Share on LinkedIn">
      <i class="fab fa-linkedin"></i>
    </a>

    <a target="_blank" href="https://www.reddit.com/submit?url=https%3A&#x2F;&#x2F;www.snoyman.com&#x2F;blog&#x2F;2018&#x2F;11&#x2F;why-i-believe-stackage-succeeded&#x2F;" title="Share on Reddit">
      <i class="fab fa-reddit"></i>
    </a>
  </div>
</div>



<!--
<div class="container" id="blog-body">
  <div class="row">
    <div class="col-lg-9">
-->
      <p>
        <i>
          See a typo? Have a suggestion?
          <a target="_blank" rel="nofollow" href="https://github.com/snoyberg/snoyman.com/edit/master/content/blog&#x2F;why-i-believe-stackage-succeeded.md">Edit this page on Github</a>
        </i>
      </p>

      <p>A few days ago I published a post on <a href="https://www.snoyman.com/blog/2018/11/stackage-history-philosophy-future">the history of
Stackage</a>. I
have another proposal coming out soon on formalizing some aspects of
the Commercial Haskell Special Interest Group. Now seems like a good
opportunity to share with you what I think makes Stackage a successful project and how we could improve Haskell resources using similar techniques.</p>
<p>Depending on how you measure it, Stackage is the largest community
project I've ever started. The Github repo has (at time of writing)
567 contributors. For some comparison, Stack has 316 contributors, the
WAI megarepo has 148, and the Yesod megarepo has 188. For those
familiar with the process, contributing to Stackage is a much lower
bar, but as you'll see, that's kind of my point here. Stackage also
has a wonderful team running it called the Stackage Curators,
consisting of <a href="https://github.com/commercialhaskell/stackage/blob/master/CURATORS.md">8
people</a>
(including myself).</p>
<p>I consider Stackage a success. It has addressed the goals I'd hoped to
achieve (see the aforementioned History of Stackage post for more
information). In this post, I'd like to explore some of the design
choices—especially on the social side—that allowed
Stackage to succeed. And then I'd like to see if we can learn some
lessons for community projects in general.</p>
<h2 id="clear-vision">Clear vision</h2>
<p>Stackage starts off with a clear vision: &quot;Stable, vetted Hackage.&quot;
That can further be described as:</p>
<ul>
<li>Grab upstream Haskell packages</li>
<li>Try to build them together</li>
<li>Try to run test suites</li>
<li>If all of that works, publish a snapshot that end users can use via
tooling like Stack, Nix, or (with some caveats) cabal-install</li>
<li>Otherwise, give package authors feedback on what went wrong</li>
</ul>
<p>This seems straightforward, and makes it easy for people to see if
they care about participating. As a trivial example, we're talking
about Haskell packages here. Someone who exclusively writes Rust knows
that they won't be interested in contributing to this project most
likely.</p>
<p>It also defines what is and is not in scope for Stackage. For example,
an oft requested feature for Stackage is the ability to upload
packages to it. This doesn't fit in with the vision defined above of
grabbing <em>upstream</em> Haskell packages. We do end up getting into some
grey areas (should Stackage patch packages like Debian does? should
Stackage accept packages from locations besides Hackage?). But this
initial vision does a lot to help guide things.</p>
<h2 id="easy-contribution">Easy contribution</h2>
<p>As I'm saying a lot recently, I'm a big believer in simplifying the
onboarding experience. Contributing a new package to Stackage is
intentionally very simple: send a pull request adding a few lines to a
YAML file and see if CI passes. We could have demanded more rigorous
criteria, like proof that the package works with the latest Stackage
Nightly. We could have used a different format than YAML. We could
have hosted the repo somewhere besides Github.</p>
<p>However, for our target audience, Github, YAML, and watching a CI
system are all fairly standard. If this was a less technical audience,
I may have instead created a web application with Google-backed
authentication and a webform for entering package names. Make the
contribution and onboarding process as easy as possible for the target
audience.</p>
<h2 id="logical-requirements">Logical requirements</h2>
<p>There is one requirement for getting a package into Stackage: it must
build and pass test cases with all of the other packages in the
snapshot. This is a machine checkable requirement, making it easy to
vet whether or not requirements have been met. And the requirements
follow directly from the vision stated above.</p>
<p>I don't think we've yet had someone object to this requirement. If you
don't want to ensure your package is compatible with other packages on
Hackage, that's fine, but clearly Stackage isn't a project you'd be
interested in contributing to. Having the requirement stem directly
from the vision reduces the scope of conflict.</p>
<p>That's not to say that there are no disagreements. We have constant
back-and-forths about how frequently LTS snapshots should be cut, how
aggressively we should prune packages with restrictive upper bounds,
when skipping tests is appropriate, etc. But the scope of these
debates is relatively contained. It also brings us to our next point:</p>
<h2 id="public-discussion">Public discussion</h2>
<p>As this blog post demonstrates, I have a tendency to over-communicate
publicly. But I think this is better than the alternative. We have a
private Stackage Curators channel for discussing day-to-day boring
matters (who's on duty, reviewing blog posts, etc). But all major
decisions these days are shared in an issue tracker, a blog post, a
mailing list, or a Gitter discussion. And usually in more than one of
those!</p>
<p>Furthermore, we try hard to document the decisions we've made in the
past. Both the
<a href="https://github.com/commercialhaskell/stackage/blob/master/MAINTAINERS.md"><code>MAINTAINERS.md</code></a>
and
<a href="https://github.com/commercialhaskell/stackage/blob/master/CURATORS.md"><code>CURATORS.md</code></a>
say quite a bit about how Stackage is run. We've tried to stress-test
these documents by having new members of the curator team onboard
themselves with the documentation, and then asking questions on what's
unclear. If information is missing, we fill it into the
documents. Ideally, little to no information is retained exclusively
in someone's head.</p>
<p>I wouldn't say we've been perfect here. In fact, I've been the biggest
culprit of problems here. When Stackage was a one-man show, I <em>did</em>
have a lot of knowledge trapped in my head undocumented. I <em>did</em>
implicitly make decisions by myself (many times without even realizing
it). The rest of the curator team has been a very good influence on
me, and has encouraged more structure in how we document and discuss
our work.</p>
<h2 id="positive-benefits-for-participation">Positive benefits for participation</h2>
<p>If someone asked me &quot;why should I participate in Stackage?&quot; I could
give some clear benefits:</p>
<ul>
<li>Get notified if your packages no longer compile with their dependencies</li>
<li>Get your test suites run in a different environment for more thorough testing</li>
<li>Make it easy to access your packages from Stack and Nix</li>
</ul>
<p>If those benefits are appealing, and outweigh the costs of
contributing to Stackage, then great! And if not, no hard
feelings. Stackage is fully opt-in, and therefore there's only
positive pressure to be a part of it, no negative backlash for failing
to comply.</p>
<h2 id="reasonably-decent-automation">Reasonably decent automation</h2>
<p>Over the years, the stackage-curator tool has evolved quite a
bit. Personally, I think the process of curating Stackage is
relatively easy. I hope my fellow curators feel the same way. But with
2,000 packages being built regularly, it would be all but impossible
to maintain Stackage without decent tooling. With that said, let's get
to improvements.</p>
<h2 id="improvements">Improvements</h2>
<p>Stackage can and should improve. I believe the two biggest areas for improvement currently are:</p>
<ul>
<li><strong>Tooling</strong> stackage-curator is good, but it's showing its
age. We've already got <a href="https://github.com/commercialhaskell/stack/issues/4217">some plans for
improvements</a>,
including possibly using Nix for doing the building (to both
simplify our tooling, and get better testing of the <code>stack2nix</code>
pipeline).</li>
<li><strong>Communications</strong> As I mentioned, the curator team has been a great
influence on better communication. We're hoping to continue
that. Some of the tooling improvements will hopefully make it easier
to communicate why packages have been held back in LTS minor bumps,
for example.</li>
</ul>
<p>I'm sure there are other improvements to be made as well, these are
just the highest two on my personal list.</p>
<h2 id="lessons-for-other-projects">Lessons for other projects</h2>
<p>As I mentioned, I'm going to be following up soon with a proposal
related to Commercial Haskell. I'm hoping the points above can
influence other projects towards making good decisions towards
success. For example, in the case of Commercial Haskell, I don't think
we've done enough to clarify the vision of the project.</p>
<p>We can also apply some of these lessons to other Haskell community
projects. For example:</p>
<ul>
<li>
<p>It seems like Hackage has a clear vision: a central package
repository for all open source Haskell code which uses the Cabal
build system. However, a secondary goal—complying with the PVP
in order to allow for dependency solving—has been a highly
contentious issue. I've already <a href="https://www.snoyman.com/blog/2018/02/haskell-ecosystem-requests">requested clarification of this
point</a>. In
my opinion, if there was a clearly stated vision for Hackage in
<em>either</em> direction, many of our problems would be solved.</p>
<ul>
<li>If the vision is &quot;central package repository,&quot; then it follows
naturally that non-PVP-compliant code should still be encouraged
to be submitted to Hackage, since that's in keeping with the
vision statement.</li>
<li>If, by contrast, PVP compliance for dependency solving is the
goal, then it makes sense that people with different goals would
upload their Haskell packages elsewhere.</li>
</ul>
</li>
<li>
<p>Haskell Platform (the original, full version) solved multiple
different goals at the same time:</p>
<ul>
<li>An easy method for installing the Haskell toolchain</li>
<li>An opinionated set of &quot;batteries included&quot; packages</li>
<li>A committee process for vetting libraries for high quality</li>
</ul>
<p>I don't see a problem with <em>any</em> of these goals. However, putting
them together created problems. For example, bundling of the
&quot;batteries included&quot; packages with HP led to a situation where it
was (with old versions of cabal-install) difficult to upgrade
packages, leading to in some cases of highly-security-vulnerable
packages being shipped for years.</p>
<p>Ultimately, the Haskell Platform Core installer addressed a large
part of this issue, since it minimized the vision of the project (an
installer provided the most common tooling, including <em>both</em>
cabal-install and Stack)</p>
</li>
<li>
<p>What's the purpose of the haskell.org homepage? This has been a
highly fought over issue, but defining a vision would have helped
significantly. What is the purpose?</p>
<ul>
<li>Convince hobbyists to try it out</li>
<li>Provide a homepage for professors to send their students to get
installation instructions</li>
<li>Be a hub for Haskell community information and discussion</li>
<li>Document all common methods of using Haskell</li>
</ul>
<p>Stating what the vision is, having public discussion about how to
achieve it, and finding methods to address alternative goals, could
greatly help with community tensions over the site.</p>
</li>
<li>
<p>Within Stack—as I mentioned in my previous post—I see some possibilities for decoupling. For example, we could separate off the GHC installation code from everything else. This mostly falls into the same category: defining a clear vision (opinionated build tool) and letting the less opinionated piece (method of installing GHC) stand on its own.</p>
</li>
<li>
<p>haskell-lang.org was <em>not</em> started correctly. The vision was wrong. It should have been something like &quot;Haskell for people who want a highly opinionated set of guidelines.&quot; The naming should have reflected that. Hopefully that's something that can be rectified in the near future.</p>
</li>
</ul>


<div class="text-center"><a href="/blog/" class="btn btn-primary">Read more blog posts</a></div>

      <div id="disqus_thread"></div>
      <script>
        (function() {var d = document, s = d.createElement('script'); s.src = '//snoyberg.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s);})();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<!--
    </div>

    <div class="col-lg-3" id="archive">
      <h3>Blog archive</h3>
      <ul class="blog-archive">
            $forall ((year, month, slug), post) <- posts
                <li>
                    <a href=@?{addPreview $ PostR year month slug}>#{postTitle post}
                    \ #
                    <i>#{prettyDay now (postTime post)}
-->

<div class="text-center"><a href="/blog/" class="btn btn-primary">Read more blog posts</a></div>


            </div>
          </div>
        </div>
      </section>
    </main>

    
<footer class="bg-dark py-5">
  <ul class="list-inline text-center text-md-right mb-0">
    <li class="list-inline-item mx-2">
      <a href="https://twitter.com/snoyberg">Follow @snoyberg</a>
    </li>
    <li class="list-inline-item mx-2">
      <a href="https://twitter.com/intent/tweet?screen_name=snoyberg">Tweet to @snoyberg</a>
    </li>
    <li class="list-inline-item mx-2">
      <a href="https://github.com/snoyberg">Github</a>
    </li>
    <li class="list-inline-item mx-2">
      <a href="https://tech.fpcomplete.com/">FP Complete</a>
    </li>
    <li class="list-inline-item mx-2">
      <a href="https://www.haskellers.com/user/snoyberg">I'm a Haskeller</a>
    </li>
  </ul>
</footer>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1434510-21', 'auto');
  ga('send', 'pageview');
</script>

<!-- JS Script Files -->
<!-- Global Vendor -->
<script src="/maxi/vendors/jquery.min.js"></script>
<script src="/maxi/vendors/jquery.migrate.min.js"></script>
<script src="/maxi/vendors/popper.min.js"></script>
<script src="/maxi/vendors/bootstrap/js/bootstrap.min.js"></script>

<!-- Components Vendor  --> 
<script src="/maxi/contact/jqBootstrapValidation.js"></script>
<!--Plugin Initialize-->
<script src="/maxi/js/global.js"></script>
<!-- END JAVASCRIPTS -->


  </body>
</html>
