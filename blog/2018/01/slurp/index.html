
    

<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>SLURP</title>

    <meta name="twitter:site" content="@snoyberg">
    <meta name="twitter:creator" content="@snoyberg">
    <meta name="og:site_name" content="Michael Snoyman's homepage">
    <meta name="og:title" content="SLURP">
    <meta name="og:type content="website">

    <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"> 
    <link rel="stylesheet" href="/maxi/vendors/font-awesome/css/fontawesome-all.min.css">
    <link rel="stylesheet" type="text/css" href="/maxi/css/styles.css">

    

<meta name="og:description" value="My comments on the SLURP proposal">






    <link rel="openid2.provider" href="https://openid.stackexchange.com/openid/provider">
    <link rel="openid2.local_id" href="https://openid.stackexchange.com/user/d26546d2-46db-4099-83ca-e1eccfa0dd8d">
    <link href="/rss.xml" type="application/atom+xml" rel="alternate" title="Michael Snoyman's blog">

    <style>.wt-section { padding-top: 2rem }</style>
  <body>
    <header class="inner-page">
      

<nav class="js-navbar-scroll navbar fixed-top navbar-expand-lg">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">
      <img src="/img/snoylogo.png" height="50px">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo" aria-controls="navbarTogglerDemo" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse onCollapse" id="navbarTogglerDemo">
      <ul class="navbar-nav ml-auto mt-2 mt-lg-0">
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="/blog">Blog</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://www.yesodweb.com/">Yesod</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="http://shop.oreilly.com/product/0636920035664.do">Yesod Book</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://www.beginrust.com/">Rust Book</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://www.youtube.com/c/snoyberg">YouTube</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://twitter.com/snoyberg">Twitter</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://github.com/snoyberg">Github</a>
        </li>
      </ul>
    </div>
  </div>
</nav>



      <section class="wt-section bg-gray text-center inner-page-header" style="padding-top:100px">
        <div class="container">
          <div class="row justify-content-md-center align-items-center text-white py-lg-5">
            <div class="col-md-7">
              <div class="text-center">
                <h1 class="display-sm-4 display-lg-3">SLURP</h1>
                
<p class="h6 text-uppercase wt-letter-spacing-sm mb-0">Published January 24, 2018</p>

              </div>
            </div>
          </div>
        </div>
      </section>
    </header>

    <main role="main">
      <section class="wt-section">
        <div class="container">
          <div class="row justify-content-between">
            <div class="col-lg-12">
              <p class="text-center">
                <a class="btn" style="background: #72472f; color: #fff; font-weight: bold" href="https://www.beginrust.com/">New: The "Begin Rust" book</a>
              </p>

              




  


<div class="share-bar-wrapper">
  <div class="share-bar-inner">
    <b>Share this</b>
    <a target="_blank" href="https://twitter.com/intent/tweet?text=SLURP https%3A&#x2F;&#x2F;www.snoyman.com&#x2F;blog&#x2F;2018&#x2F;01&#x2F;slurp&#x2F;" title="Share on Twitter">
      <i class="fab fa-twitter"></i>
    </a>

    <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A&#x2F;&#x2F;www.snoyman.com&#x2F;blog&#x2F;2018&#x2F;01&#x2F;slurp&#x2F;" title="Share on Facebook">
      <i class="fab fa-facebook"></i>
    </a>

    <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A&#x2F;&#x2F;www.snoyman.com&#x2F;blog&#x2F;2018&#x2F;01&#x2F;slurp&#x2F;&amp;title=SLURP" title="Share on LinkedIn">
      <i class="fab fa-linkedin"></i>
    </a>

    <a target="_blank" href="https://www.reddit.com/submit?url=https%3A&#x2F;&#x2F;www.snoyman.com&#x2F;blog&#x2F;2018&#x2F;01&#x2F;slurp&#x2F;" title="Share on Reddit">
      <i class="fab fa-reddit"></i>
    </a>
  </div>
</div>



<!--
<div class="container" id="blog-body">
  <div class="row">
    <div class="col-lg-9">
-->
      <p>
        <i>
          See a typo? Have a suggestion?
          <a target="_blank" rel="nofollow" href="https://github.com/snoyberg/snoyman.com/edit/master/content/blog&#x2F;slurp.md">Edit this page on Github</a>
        </i>
      </p>

      <p>Many people in the community have seen the SLURP proposal. Some people
have asked my opinion. Some others have made some... let's say
<em>colorful</em> statements about my noninvolvement in the discussion. Let
me set the record straight right now on why I've avoided the
topic. The authors showed me the proposal before it was published, and
I told them at that time I would not support it. I've also told them
that, out of respect to them, I would hold back on commenting on
SLURP. Unfortunately, that's now led to two things:</p>
<ul>
<li>Some people making some very pointed implications</li>
<li>Misunderstanding about the usage of the term &quot;fork&quot; in the proposal,
which unfortunately the authors have not rectified</li>
</ul>
<p>To be clear: the proposal is <em>not</em> mine, I did <em>not</em> ask for this
change, and I'm not &quot;holding a gun&quot; to anyone's head. Those
descriptions aren't true.  There are plenty of other statements I
could comment on as well, but it's honestly not worth it.</p>
<p>Here's what isn't false: I regularly am in communication with many
people across the Haskell community and ecosystem management teams
about problems being faced. I interact with a broad group of users in
my work, hear complaints, and relay them. I have my own complaints,
and relay those as well. Some of these complaints have all pointed in
similar directions.</p>
<p>My hands are tied on what I can say publicly, since so many comments
are made in private emails that people object to being made
public. And I know (from experience) that there are detractors out
there who will straight out accuse me of lying. I've been avoiding
saying anything because of this constant accusation, but I've decided
to just put the info out there. I figure:</p>
<ul>
<li>People who want to believe everything I do is malicious won't care
if I have evidence anyway</li>
<li>People who are open to the possibility that I'm not evil will
hopefully take my statements at face value</li>
</ul>
<p>One last foreword: I used to very openly discuss my thoughts on
architecture and ecosystem development. I believe it's the only real
way to build an open source community. When tensions got their highest
in the Stack-vs-cabal days, many people rebelled against this public
broadcast methodology, and I've switched to quieter communication
channels. I think this is unfortunate, and I'd much rather talk openly
and loudly about ecosystem plans and let people have easy ways of
input. I object strongly to the mentality of discussing everything
behind closed doors. We'll see if open discussions can resume at some
point.</p>
<h2 id="what-s-the-fork">What's the fork?</h2>
<p>It seems clear to me now that the vast majority of discussion on SLURP
has nothing to do with SLURP itself, but with its comments about
forking. I really do wish that the authors had been willing to speak
to that publicly if they were going to use the term fork in the
document. I will speak to what I know about forking in the Stackage
and Stack worlds. We'll have to leave it to the authors to speak for
themselves as to whether my words here reflect what they'd intended.</p>
<p>The term &quot;fork&quot; here is definitely not being used in its most literal
sense of &quot;taking a software project, hosting the source code
elsewhere, then continuing development under a different name&quot; (my
made up definition). It's referring to a more general split. Stack is
called by many a fork of cabal-install, for example, even though they
share no code (they share underlying libraries, like Cabal, of
course).</p>
<p>Since everyone is most fixated on this point, let me state it clearly:
I have been involved in absolutely 0 conversations where anyone wanted
to host a direct competitor to Hackage. At all. No one I know wants to
do this. I don't want to do this. Stackage and Stack today feed from
Hackage, and no one I know wants to change that. No one I know wants
to try to take over control of Hackage, for that matter.</p>
<p>When &quot;fork&quot; of Hackage is mentioned, that seems like the most logical
conclusion to draw. I can guarantee that it's not the case.</p>
<p>Now let me address some concrete pain points that may lead to some
kind of &quot;fork.&quot;</p>
<h2 id="hackage-revisions">Hackage Revisions</h2>
<p>Many people are very outspoken about their dislike for Hackage
Revisions. I dislike Hackage Revisions. I have more reason than most
to dislike them: I've invested weeks to months of my life making
changes to multiple tools to support revisions. I could go through the
gory history of this, but it's not worth it: it would just be a
programmer's war stories session. So let's turn to today.</p>
<p>With Stack 1.6, I finally got all of the pieces in place to fully
support revision pinnings. Stackage has already had revision pinning
for a long time. Stackage has the ability to list some packages as
ignoring revisions.</p>
<p>If you ask me today, I will still say revisions are a bad idea, they
should be disabled, and better solutions to the dependency resolution
problem implemented (I've discussed those at length in the past). At
the same time: the cost is now sunk. I still worry about the fact that
users do not, in fact, pin their extra-deps to specific revisions, and
that the rules for revisions on Hackage are far too lax. These a real
concerns that I care about, but also not the top of my personal
priority list.</p>
<p>Others, by the way, feel differently. I know many individuals who are
offended at the thought of a Hackage Trustee forcibly editing their
cabal files. I don't disagree with them per se, but I'm also not as
passionate about this topic. In conversations with community leaders,
I've made this distinction very clear (at least, I've <em>tried</em> to make
it clear).</p>
<p>My biggest remaining concern about revisions is the social implication
they carry. Namely: the idea that someone else is responsible for the
stability of your build. I've mentioned many times that I believe a
huge source of our social tension is a world where you can complain to
an upstream developer because your build suddenly stopped
working. That's a recipe for disaster, and is a fundamental flaw in
the PVP+dependency solving world. We need tooling that focuses instead
on fixed build plans. I've advocated for this for years, and
ultimately created Stack largely due to inability to get traction
upstream.</p>
<p>In sum: will revisions lead to anything of a fork? No.</p>
<h2 id="curation">Curation</h2>
<p>A few weeks ago I tweeted:</p>
<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">I did that initially. When collaborating on GPS Haskell, I removed that functionality as a requirement of the Hackage, Cabal, and Haskell Platform teams. Then GPS died and we&#39;re stuck unable to work around upstream breakage like this.</p>&mdash; Michael Snoyman (@snoyberg) <a href="https://twitter.com/snoyberg/status/949385673982730240?ref_src=twsrc%5Etfw">January 5, 2018</a></blockquote>
<p>The original design of Stackage followed a standard Linux distribution
model directly. Hackage was our upstream, we maintained a set of
patches to avoid massive version bound disruption, and <em>very</em>
occasionally (if at all, I honestly don't remember) edited source
files to fix bugs.</p>
<p>In 2014, when I discussed the plans for incorporating Stackage into
cabal and the Haskell Platform (code named GPS Haskell, and which
never got off the ground), the cabal, Hackage, and HP maintainers
required that Stackage not maintain any local modifications. I removed
that functionality, and that's the world we've been in since.</p>
<p>Adding that back <em>is</em> on the table. I'll explain why in a second. This
could be considered a fork, and some may call it a soft fork. It's
honestly not a feature I want to add back to Stackage, since
maintaining patch sets is a lot of work. But many communities need to
do it. As I understand it, Nix does it as well. So if it's a fork,
it's a fork we already have widely in our ecosystem.</p>
<p>One &quot;nice to have&quot; reason for adding in this curation is to work
around packages which are slow to upgrade to newer dependency
versions. It can be very frustrating for Stackage package maintainers
to have their packages held back because <em>someone else</em> won't relax an
upper bound. Curation would let us work around that. I consider this a
perk, but not a necessity.</p>
<p>But the more important reason for this is to deal with packages which
are causing trouble in the Stackage or Stack world, but are not
causing trouble in the cabal-install world. I didn't consider this a
real concern until it happened multiple times in the past few
months. You can
<a href="https://github.com/haskell-hvr/cassava/pull/155">see an example here</a>.</p>
<p>I'm not demanding anything of any authors by making this
statement. But here's the reality: I personally end up spending a lot
of my own time dealing with these kinds of breakages. My friends and
colleagues get sucked into various carry-on tasks, like cutting new
emergency point releases. I do not want my life to be spent in a
situation where, at a moment's notice, I'll need to dedicate large
amounts of time to changing something in Stack to be compliant with
something in the Cabal library which <em>should</em> be in a spec, but is
instead undocumented.</p>
<p>Hackage already takes great pains to ensure it does not break
cabal-install. Many people have probably heard about how the <code>^&gt;=</code>
operator's introduction broke Stack 1.5. What many people <em>didn't</em>
hear about is that it also broke cabal-install 1.24. You didn't hear
about it, because
<a href="https://github.com/haskell/cabal/issues/4624">Hackage implemented a workaround to hide those files from older cabal-install versions</a>. This
curation idea is to provide a way for Stackage to work around breakage
for Stack, the same way Hackage will work around damage for
cabal-install.</p>
<p>And yes: I requested that the same kind of treatment be given to Stack
from Hackage. That was met with calls of asking for preferential
treatment. Readers can determine what they feel.</p>
<p>In sum: I'm working towards allowing Stackage to apply patches to
upstream packages. I don't consider this a fork, but rather
curation. Others may choose to label it a fork.</p>
<h2 id="avoid-uploading-to-hackage">Avoid uploading to Hackage</h2>
<p>I'll start with this: my personal preference is to continue uploading
all of my packages to Hackage. I have no intention nor desire to stop
uploading conduit, yesod, or any of the other 80+ packages I actively
maintain to Hackage. That said, not everyone feels the same way.</p>
<p>Today, Stackage is strictly downstream of Hackage. You cannot get a
package into Stackage unless it is first uploaded to Hackage. Period,
end of story. There seem to be three groups of people pushing towards
the ability to change this:</p>
<ol>
<li>At least some PVP advocates have requested (or demanded) that
package authors who will not follow the PVP do not upload their
packages to Hackage. This is absolutely contradicted by the
official guidelines of Hackage, which I've pointed out many
times. Nonetheless, this request/demand has persisted.</li>
<li>Some opposed to the PVP do not want to upload to Hackage, basically
because of (1). There have been many tense altercations over
adherence to the PVP. People want to avoid this, and the easiest
way is if they don't upload to Hackage. I know some people who
simply do not release their code to Hackage or Stackage because of
this. Others do so begrdugingly. But all of them would like to
avoid Hackage for this reason.</li>
<li>Some people feel that, technically, the central repo with manually
uploaded tarball model is outdated. They would rather see a
workflow based on automated Git-based releases using tags or a
release branch. This is not a social dynamic <em>at all</em>, but a desire
to explore a different point in the technical space, which Hackage
does not support today.</li>
</ol>
<p>(1) has been a major pain point for me. I've requested changes to the
Hackage Trustee guidelines and Hackage rules to clarify that this
behavior (private emails demanding people not upload to Hackage,
public criticisms on individuals and companies for not following the
PVP, etc) should not be allowed. In fact, <em>that request</em> is what
ultimately led to SLURP as far as I know. Did I demand a change with a
threat to fork? Ehh... if you want to read it that way, OK. Here's my
take: I've been told to stop using Hackage, full stop. I requested a
change in official policy to guarantee that my usage of Hackage is
allowed.</p>
<p>As it stands today, no such change to Hackage policy has taken
place. No final decision has been made about how I will respond to
people in groups (2) and (3). But as you can see from the sentiments
of group (3), the idea of hosting an alternative package repository to
Hackage makes no sense. Thus I can again guarantee: the most literal
fork of Hackage is something neither I nor anyone I'm speaking with
wants.</p>
<p>The other alternative is allowing Stackage to pull packages directly
from Git repos, in addition to pulling from Hackage. This is being
discussed as a workaround for problem (1) above. I have gone on record
in the past, and I'll go on record again now: I would rather <em>not</em>
have that situation. I would rather Hackage make it clear that it
welcomes everyone to upload its packages, and then the demands I'm
receiving to open up Stackage to alternative sources will be less
strong (though group (3) still wants to experiment for purely
technical reasons).</p>
<p>Am I holding a gun to someone's head? Your call. This is the most
honest version of the story I know to tell.</p>
<p>In sum: this is the closest to a potential fork, by allowing Git repos
to work as an alternative source to Hackage.</p>
<h2 id="summary">Summary</h2>
<p>I've participated in a long, private discussion with multiple people
in trying to resolve the issues referenced above. As I said: my
preference has always been for public discussions. Given how the SLURP
proposal went off, I will stand by my original claim that public
discussions are a better method. I'm sorry that the &quot;fork&quot; phrasing
scared so many people. To those who were truly terrified I was going
to do something nefarious: I'm sorry to keep you waiting two days in
an explanation.</p>


<div class="text-center"><a href="/blog/" class="btn btn-primary">Read more blog posts</a></div>

      <div id="disqus_thread"></div>
      <script>
        (function() {var d = document, s = d.createElement('script'); s.src = '//snoyberg.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s);})();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<!--
    </div>

    <div class="col-lg-3" id="archive">
      <h3>Blog archive</h3>
      <ul class="blog-archive">
            $forall ((year, month, slug), post) <- posts
                <li>
                    <a href=@?{addPreview $ PostR year month slug}>#{postTitle post}
                    \ #
                    <i>#{prettyDay now (postTime post)}
-->

<div class="text-center"><a href="/blog/" class="btn btn-primary">Read more blog posts</a></div>


            </div>
          </div>
        </div>
      </section>
    </main>

    
<footer class="bg-dark py-5">
  <ul class="list-inline text-center text-md-right mb-0">
    <li class="list-inline-item mx-2">
      <a href="https://twitter.com/snoyberg">Follow @snoyberg</a>
    </li>
    <li class="list-inline-item mx-2">
      <a href="https://twitter.com/intent/tweet?screen_name=snoyberg">Tweet to @snoyberg</a>
    </li>
    <li class="list-inline-item mx-2">
      <a href="https://github.com/snoyberg">Github</a>
    </li>
    <li class="list-inline-item mx-2">
      <a href="https://tech.fpcomplete.com/">FP Complete</a>
    </li>
    <li class="list-inline-item mx-2">
      <a href="https://www.haskellers.com/user/snoyberg">I'm a Haskeller</a>
    </li>
  </ul>
</footer>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1434510-21', 'auto');
  ga('send', 'pageview');
</script>

<!-- JS Script Files -->
<!-- Global Vendor -->
<script src="/maxi/vendors/jquery.min.js"></script>
<script src="/maxi/vendors/jquery.migrate.min.js"></script>
<script src="/maxi/vendors/popper.min.js"></script>
<script src="/maxi/vendors/bootstrap/js/bootstrap.min.js"></script>

<!-- Components Vendor  --> 
<script src="/maxi/contact/jqBootstrapValidation.js"></script>
<!--Plugin Initialize-->
<script src="/maxi/js/global.js"></script>
<!-- END JAVASCRIPTS -->


  </body>
</html>
