
    

<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>Enough with Backwards Compatibility</title>

    <meta name="twitter:site" content="@snoyberg">
    <meta name="twitter:creator" content="@snoyberg">
    <meta name="og:site_name" content="Michael Snoyman's homepage">
    <meta name="og:title" content="Enough with Backwards Compatibility">
    <meta name="og:type content="website">

    <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"> 
    <link rel="stylesheet" href="/maxi/vendors/font-awesome/css/fontawesome-all.min.css">
    <link rel="stylesheet" type="text/css" href="/maxi/css/styles.css">

    






    <link rel="openid2.provider" href="https://openid.stackexchange.com/openid/provider">
    <link rel="openid2.local_id" href="https://openid.stackexchange.com/user/d26546d2-46db-4099-83ca-e1eccfa0dd8d">
    <link href="/rss.xml" type="application/atom+xml" rel="alternate" title="Michael Snoyman's blog">

    <style>.wt-section { padding-top: 2rem }</style>
  <body>
    <header class="inner-page">
      

<nav class="js-navbar-scroll navbar fixed-top navbar-expand-lg">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">
      <img src="/img/snoylogo.png" height="50px">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo" aria-controls="navbarTogglerDemo" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse onCollapse" id="navbarTogglerDemo">
      <ul class="navbar-nav ml-auto mt-2 mt-lg-0">
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="/blog">Blog</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://www.yesodweb.com/">Yesod</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="http://shop.oreilly.com/product/0636920035664.do">Yesod Book</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://www.beginrust.com/">Rust Book</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://www.youtube.com/c/snoyberg">YouTube</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://twitter.com/snoyberg">Twitter</a>
        </li>
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          <a class="nav-link" href="https://github.com/snoyberg">Github</a>
        </li>
      </ul>
    </div>
  </div>
</nav>



      <section class="wt-section bg-gray text-center inner-page-header" style="padding-top:100px">
        <div class="container">
          <div class="row justify-content-md-center align-items-center text-white py-lg-5">
            <div class="col-md-7">
              <div class="text-center">
                <h1 class="display-sm-4 display-lg-3">Enough with Backwards Compatibility</h1>
                
<p class="h6 text-uppercase wt-letter-spacing-sm mb-0">Published April  1, 2017</p>

              </div>
            </div>
          </div>
        </div>
      </section>
    </header>

    <main role="main">
      <section class="wt-section">
        <div class="container">
          <div class="row justify-content-between">
            <div class="col-lg-12">
              <p class="text-center">
                <a class="btn" style="background: #72472f; color: #fff; font-weight: bold" href="https://www.beginrust.com/">New: The "Begin Rust" book</a>
              </p>

              




  


<div class="share-bar-wrapper">
  <div class="share-bar-inner">
    <b>Share this</b>
    <a target="_blank" href="https://twitter.com/intent/tweet?text=Enough%20with%20Backwards%20Compatibility https%3A&#x2F;&#x2F;www.snoyman.com&#x2F;blog&#x2F;2017&#x2F;04&#x2F;enough-with-backwards-compatibility&#x2F;" title="Share on Twitter">
      <i class="fab fa-twitter"></i>
    </a>

    <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A&#x2F;&#x2F;www.snoyman.com&#x2F;blog&#x2F;2017&#x2F;04&#x2F;enough-with-backwards-compatibility&#x2F;" title="Share on Facebook">
      <i class="fab fa-facebook"></i>
    </a>

    <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A&#x2F;&#x2F;www.snoyman.com&#x2F;blog&#x2F;2017&#x2F;04&#x2F;enough-with-backwards-compatibility&#x2F;&amp;title=Enough%20with%20Backwards%20Compatibility" title="Share on LinkedIn">
      <i class="fab fa-linkedin"></i>
    </a>

    <a target="_blank" href="https://www.reddit.com/submit?url=https%3A&#x2F;&#x2F;www.snoyman.com&#x2F;blog&#x2F;2017&#x2F;04&#x2F;enough-with-backwards-compatibility&#x2F;" title="Share on Reddit">
      <i class="fab fa-reddit"></i>
    </a>
  </div>
</div>



<!--
<div class="container" id="blog-body">
  <div class="row">
    <div class="col-lg-9">
-->
      <p>
        <i>
          See a typo? Have a suggestion?
          <a target="_blank" rel="nofollow" href="https://github.com/snoyberg/snoyman.com/edit/master/content/blog&#x2F;enough-with-backwards-compatibility.md">Edit this page on Github</a>
        </i>
      </p>

      <p>To get things started correctly, I'd like to define backwards
compatibility as the following:</p>
<blockquote>
<p>Maintaining the invariant that, amongst successive versions of a
library or tool, software using that library or tool continues to
build and execute with matching semantics (though perhaps different
performance characteristics).</p>
</blockquote>
<p>There is some wiggle room for defining if a change is properly
backwards compatible. If we introduce a new identifier which conflicts
with an old one, this may break a build, but most people accept this
as &quot;backwards compatible enough.&quot; Also, fixing a bug in an
implementation may, in some cases,
<a href="https://xkcd.com/1172/">break something</a>. But let's ignore the subtle
cases, and instead just focus on the big picture: I released some new
library, and it changed the type signature of a function, tweaked a
data type, or significantly altered runtime behavior.</p>
<p>Let's just cut to the chase: striving for backwards compatibility is
stupid, and we should stop doing it. I'm going to demonstrate why.</p>
<h2 id="it-doesn-t-stop-bugs">It doesn't stop bugs</h2>
<p>Let's take as an assumption that you're actually writing proper
changelogs for your libraries (seriously, please write proper
changelogs for your libraries). If so, there's no reason why backwards
compatibility is useful for preventing bugs.</p>
<p>When you are using a library, you're responsible for keeping up to
date with new versions. When a new version of any dependency comes
out, it's your sworn duty and sacred obligation to thoroughly review
the changelog and ensure that any changes that may affect you are
addressed in your code. It's just the bare minimum of good code
maintenance.</p>
<p>I'll leave as a given that everyone is using some version of Semantic
Versioning (SemVer), so breaking changes will never accidentally
affect their code bases.</p>
<h2 id="it-s-time-well-spent">It's time well spent!</h2>
<p>This may sound like a lot of time invested on a maintainers
part. While it certainly takes some effort, this is an investment in
your future, not just an expenditure. Requiring this maintenance level
from library authors is a great forcing function:</p>
<ul>
<li>It proves you're serious about maintaining your code. When I'm
choosing between different libraries for a task, the library with
regular updates to address changes in dependencies is always the
higher quality one.</li>
<li>Conversely, a lack of frequent updates tells you that you shouldn't
trust a piece of code. Bitrot is no joke; code gets bad over time!
Having something that forces you to change code regularly is the
best way to avoid bitrot.</li>
<li>It properly penalizes you for using too many
dependencies. Encouraging decreased dependencies is a great way to
avoid dependency problems!</li>
</ul>
<h2 id="failure-cases">Failure cases</h2>
<p>I want to take as a case example two well-known cases of well
maintained backwards compatibility, and demonstrate how destructive it
is.</p>
<h3 id="java">Java</h3>
<p>Java is well known as an ecosystem that prefers stability over
elegance, and we can see that this has led to a completely dead,
non-viable platform. When generics were added to Java, they had the
choice to either break their existing containers APIs, or add a brand
new API. As we know, they made the foolish choice to introduce a brand
new API, creating clutter (we <em>hate</em> clutter!).</p>
<p>But worse: it allowed old code to continue to run unmodified. How can
we trust that that code is any good if no one has been forced to
update it to newer APIs? They wasted a great opportunity for a quality
forcing function on the entire ecosystem.</p>
<h3 id="sqlite3">sqlite3</h3>
<p>Once again seriously: sqlite3 is probably the most
<a href="http://sqlite.org/capi3ref.html">well designed C API</a> I've ever seen,
and by far the best low-level database API I've seen. Everything seems
great with it.</p>
<p>But unfortunately, a few functions were misdesigned. For example, the
<code>sqlite3_prepare</code> function was designed in such a way, leading to
degraded error reporting behavior. To rectify this situation, the
author made the (misguided) decision to introduce a new API,
<code>sqlite3_prepare_v2</code>, with a different type signature, which allows
for better error reporting. (You can
<a href="http://sqlite.org/capi3ref.html#sqlite3_prepare">read the details yourself</a>.)</p>
<p>This allows existing programs to continue to compile and run
unmodified, even allowing them to upgrade to newer sqlite3 versions to
get performance and stability enhancements. What a disaster!</p>
<ul>
<li>There's nothing forcing programmers to use the newer, better API</li>
<li>The API just <em>looks</em> ugly. Who in the world wants a <code>_v2</code> suffix?
Terrible!</li>
<li>Someone might accidentally use the old version of the
function. Sure, it's well documented in the API docs to use the new
one, but unlike changelogs, no one actually reads API docs. Even in
a language like Haskell with a deprecation mechanism it wouldn't
matter, since everyone just ignores warnings.</li>
</ul>
<p>Obviously, the right decision was to create a new major version of
sqlite (sqlite4), rename all of the functions, update the changelog,
and force everyone to update their codebases. Why the author didn't
see this is beyond me.</p>
<h2 id="dynamically-typed-languages">Dynamically typed languages</h2>
<p>Let's say you go ahead and make a breaking change to a library in a
dynamically typed language. Obviously all of your users should just
read the changelog and update their code appropriately. There's no
compiler to enforce things of course, so it's more likely that things
will fail at runtime. That's fine, if you're using a dynamically typed
language you deserve to have your code break.</p>
<h2 id="statically-typed">Statically typed</h2>
<p>The story with statically typed languages is—as
always—better. There are two kinds of breaking changes we should
discuss.</p>
<h3 id="changed-type-signature">Changed type signature</h3>
<p>Or more broadly: things that lead to a compiler error. I don't even
understand why people talk about these. The compiler tells you exactly
what you need to do. This is redundant information with the changelog!
How dense can you be! Just try to compile your code and fix things. It
couldn't be easier. I can't even right now.</p>
<h3 id="semantic-change">Semantic change</h3>
<p>Sometimes a function keeps its signature but changes its behavior,
leading to code which will compile but behave differently. Sure,
that's bad, but if you're too lazy to read the changelog and
meticulously go through your codebase to see if you're affected in any
way, you shouldn't be writing software.</p>
<h2 id="conclusion">Conclusion</h2>
<p>I hope we can put this silly discussion to bed already. Break APIs!
Not only does it lead to more beautiful libraries, but the forced
breakage is good for the ecosystem. I hope the software engineering
community can finally start to take responsibility for doing proper
software maintenance.</p>


<div class="text-center"><a href="/blog/" class="btn btn-primary">Read more blog posts</a></div>

      <div id="disqus_thread"></div>
      <script>
        (function() {var d = document, s = d.createElement('script'); s.src = '//snoyberg.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s);})();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<!--
    </div>

    <div class="col-lg-3" id="archive">
      <h3>Blog archive</h3>
      <ul class="blog-archive">
            $forall ((year, month, slug), post) <- posts
                <li>
                    <a href=@?{addPreview $ PostR year month slug}>#{postTitle post}
                    \ #
                    <i>#{prettyDay now (postTime post)}
-->

<div class="text-center"><a href="/blog/" class="btn btn-primary">Read more blog posts</a></div>


            </div>
          </div>
        </div>
      </section>
    </main>

    
<footer class="bg-dark py-5">
  <ul class="list-inline text-center text-md-right mb-0">
    <li class="list-inline-item mx-2">
      <a href="https://twitter.com/snoyberg">Follow @snoyberg</a>
    </li>
    <li class="list-inline-item mx-2">
      <a href="https://twitter.com/intent/tweet?screen_name=snoyberg">Tweet to @snoyberg</a>
    </li>
    <li class="list-inline-item mx-2">
      <a href="https://github.com/snoyberg">Github</a>
    </li>
    <li class="list-inline-item mx-2">
      <a href="https://tech.fpcomplete.com/">FP Complete</a>
    </li>
    <li class="list-inline-item mx-2">
      <a href="https://www.haskellers.com/user/snoyberg">I'm a Haskeller</a>
    </li>
  </ul>
</footer>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1434510-21', 'auto');
  ga('send', 'pageview');
</script>

<!-- JS Script Files -->
<!-- Global Vendor -->
<script src="/maxi/vendors/jquery.min.js"></script>
<script src="/maxi/vendors/jquery.migrate.min.js"></script>
<script src="/maxi/vendors/popper.min.js"></script>
<script src="/maxi/vendors/bootstrap/js/bootstrap.min.js"></script>

<!-- Components Vendor  --> 
<script src="/maxi/contact/jqBootstrapValidation.js"></script>
<!--Plugin Initialize-->
<script src="/maxi/js/global.js"></script>
<!-- END JAVASCRIPTS -->


  </body>
</html>
